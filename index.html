<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Barma≈Ñski</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- START SCREEN -->
        <div v-if="currentScreen === 'start'" class="screen">
            <div class="container">
                <h1>üç∏ Quiz Barma≈Ñski</h1>
                <p class="subtitle">Wybierz kategorie i sprawd≈∫ swojƒÖ wiedzƒô o drinkach!</p>

                <!-- Kategorie Alkoholi -->
                <div class="section">
                    <h3>üç∑ Wybierz kategorie alkoholi</h3>
                    <p class="help-text">Pytania bƒôdƒÖ dotyczyƒá tylko wybranych kategorii</p>

                    <div class="alcohol-categories">
                        <label v-for="(selected, category) in selectedAlcoholCategories" 
                               :key="category" 
                               class="category-option">
                            <input type="checkbox" 
                                   v-model="selectedAlcoholCategories[category]">
                            <div class="category-name">
                                <span>{{ getCategoryEmoji(category) }}</span>
                                <span>{{ category }}</span>
                            </div>
                        </label>
                    </div>

                    <div v-if="hasSelectedAlcoholCategories" class="selected-info">
                        Wybrane: {{ selectedIngredientsCount }}
                    </div>
                </div>

                <!-- Kategorie Quiz√≥w -->
                <div class="section">
                    <h3>üéØ Wybierz rodzaje pyta≈Ñ</h3>

                    <div class="quiz-categories">
                        <label class="category-option">
                            <input type="checkbox" v-model="selectedCategories.proportions">
                            <div>
                                <strong>üß™ Proporcje sk≈Çadnik√≥w</strong>
                                <div class="description">Sprawd≈∫ znajomo≈õƒá dok≈Çadnych proporcji w drinkach</div>
                            </div>
                        </label>

                        <label class="category-option">
                            <input type="checkbox" v-model="selectedCategories.review">
                            <div>
                                <strong>üîç PrzeglƒÖd sk≈Çadnik√≥w</strong>
                                <div class="description">Czy dany sk≈Çadnik nale≈ºy do receptury?</div>
                            </div>
                        </label>

                        <label class="category-option">
                            <input type="checkbox" v-model="selectedCategories.vodka">
                            <div>
                                <strong>üçÄ Quiz w√≥dkowy</strong>
                                <div class="description">Pytania o marki w√≥dek, ceny i sk≈Çadniki</div>
                            </div>
                        </label>

                        <label class="category-option">
                            <input type="checkbox" v-model="selectedCategories.builder">
                            <div>
                                <strong>üèóÔ∏è Konstruktor drink√≥w</strong>
                                <div class="description">Zbuduj drink od podstaw: sk≈Çadniki, proporcje, szk≈Ço</div>

                                <div v-if="selectedCategories.builder" class="practice-mode-option">
                                    <label class="practice-toggle">
                                        <input type="checkbox" v-model="practiceMode">
                                        <span class="practice-label">üéì Zawsze dobrze! (powtarzasz drinka do puki nie zrobisz go dobrze)</span>
                                    </label>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="actions">
                    <button v-if="hasSelectedCategories && hasSelectedAlcoholCategories" 
                            @click="startQuiz" 
                            class="btn btn-primary">
                        üöÄ Rozpocznij Quiz
                    </button>
                    <button v-else class="btn btn-primary disabled">
                        Wybierz kategorie aby kontynuowaƒá
                    </button>
                </div>

                <div v-if="!hasSelectedAlcoholCategories" class="warning">
                    ‚ö†Ô∏è Wybierz przynajmniej jednƒÖ kategoriƒô alkoholu!
                </div>
            </div>
        </div>

        <!-- QUIZ SCREEN -->
        <div v-if="currentScreen === 'quiz'" class="screen quiz-screen">
            <div class="container">
                <!-- Progress -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" :style="{ width: progressWidth }"></div>
                    </div>
                    <div class="progress-text">
                        Pytanie {{ currentQuestionIndex + 1 }} z {{ questions.length }}
                    </div>
                </div>

                <!-- Pytanie normalne -->
                <div v-if="currentQuestion.type !== 'builder'" class="question-container">
                    <div class="question">
                        <h2>{{ currentQuestion.question }}</h2>
                    </div>

                    <!-- Zwyk≈Çe odpowiedzi -->
                    <div v-if="!currentQuestion.answers || currentQuestion.answers.length <= 4" 
                         class="answers-grid simple-answers">
                        <button v-for="(answer, index) in shuffledAnswers" 
                                :key="index"
                                @click="answerQuestion(index)"
                                :disabled="answerSelected"
                                :class="['answer-btn', getAnswerClass(index)]">
                            {{ answer }}
                        </button>
                    </div>

                    <!-- Wy≈õwietlenie przepisu po odpowiedzi -->
                    <div v-if="showRecipe" class="recipe-reveal">
                        <h4>üìù Przepis na {{ currentQuestion.drinkName }}:</h4>
                        <div class="recipe">
                            <div v-for="ingredient in currentRecipe" :key="ingredient.name" class="ingredient">
                                <span class="name">{{ ingredient.name }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Info o proporcjach -->
                    <div v-if="showProportionsInfo" class="recipe-reveal">
                        <h4>{{ currentQuestion.correctInfo }}</h4>
                    </div>

                    <div class="score-info">
                        Punkty: {{ score }} / {{ currentQuestionIndex + (answerSelected ? 1 : 0) }}
                    </div>
                </div>

                <!-- Builder Mode -->
                <div v-if="currentQuestion.type === 'builder'" class="question-container">
                    <div class="question">
                        <h2>üèóÔ∏è Zbuduj drink: {{ currentQuestion.drinkName }}</h2>
                    </div>

                    <!-- Krok 1: Wybierz sk≈Çadniki -->
                    <div v-if="builderStep === 1" class="builder-step">
                        <h4>Krok 1: Wybierz sk≈Çadniki ({{ selectedIngredientsCount }} wybranych)</h4>

                        <div class="ingredients-categorized">
                            <div v-for="group in groupedIngredientsForBuilder" :key="group.categoryName">
                                <div class="ingredient-category-header">
                                    <h5>{{ group.categoryName }}</h5>
                                </div>
                                <div class="ingredient-category-content">
                                    <button v-for="ingredient in group.ingredients" 
                                            :key="ingredient"
                                            @click="toggleIngredient(ingredient)"
                                            :class="['ingredient-btn', { 'selected': selectedIngredients.has(ingredient) }]"
                                            :title="ingredient">
                                        {{ ingredient }}
                                    </button>
                                </div>
                            </div>
                        </div>

                        <button @click="checkIngredients" class="btn btn-primary">
                            ‚úÖ Sprawd≈∫ sk≈Çadniki
                        </button>
                    </div>

                    <!-- Krok 2: Wprowad≈∫ proporcje -->
                    <div v-if="builderStep === 2" class="builder-step">
                        <h4>Krok 2: Wprowad≈∫ proporcje sk≈Çadnik√≥w (ml)</h4>

                        <div class="proportions-input">
                            <div v-for="(amount, ingredient) in ingredientAmounts" 
                                 :key="ingredient" 
                                 class="proportion-item">
                                <label>{{ ingredient }}</label>
                                <input v-model="ingredientAmounts[ingredient]" 
                                       type="number" 
                                       placeholder="ml">
                                <span>ml</span>
                            </div>
                        </div>

                        <button @click="checkProportions" class="btn btn-primary">
                            ‚öñÔ∏è Sprawd≈∫ proporcje
                        </button>
                    </div>

                    <!-- Krok 3: Wybierz szk≈Ço -->
                    <div v-if="builderStep === 3" class="builder-step">
                        <h4>Krok 3: Wybierz odpowiednie szk≈Ço</h4>

                        <div class="glasses-grid">
                            <button v-for="glass in shuffledGlassOptions" 
                                    :key="glass"
                                    @click="selectGlass(glass)"
                                    :class="['glass-btn', { 'selected': selectedGlass === glass }]">
                                {{ glass }}
                            </button>
                        </div>

                        <button @click="checkGlass" class="btn btn-primary">
                            ü•É Sprawd≈∫ szk≈Ço
                        </button>
                    </div>

                    <!-- Wy≈õwietlenie b≈Çƒôdnej odpowiedzi -->
                    <div v-if="showBuilderRecipe" class="recipe-reveal error">
                        <h4>‚ùå Niepoprawnie! Poprawny przepis:</h4>
                        <div class="recipe">
                            <div v-for="ingredient in builderCorrectRecipeWithNames" 
                                 :key="ingredient.name" 
                                 class="ingredient">
                                <span class="amount">**{{ ingredient.amount }} ml**</span>
                                <span class="name">{{ ingredient.name }}</span>
                            </div>
                        </div>
                        <p><strong>Szk≈Ço:</strong> {{ currentQuestion.correctGlass }}</p>
                        <p><strong>Dekoracja:</strong> {{ currentQuestion.decoration }}</p>
                    </div>

                    <!-- Sukces -->
                    <div v-if="showDecorationSuccess" class="success-message">
                        <h4>üéâ Doskonale! Drink zosta≈Ç zbudowany prawid≈Çowo!</h4>
                        <p><strong>Dekoracja:</strong> {{ currentQuestion.decoration }}</p>
                    </div>

                    <div class="score-info">
                        Punkty: {{ score }} / {{ currentQuestionIndex + 1 }}
                    </div>
                </div>
            </div>
        </div>

        <!-- RESULT SCREEN -->
        <div v-if="currentScreen === 'result'" class="screen">
            <div class="container">
                <h1>üèÜ Wyniki Quiz</h1>

                <div class="final-score">
                    <div class="score-circle">
                        <div>
                            <div class="score">{{ score }}</div>
                            <div class="total">/ {{ questions.length }}</div>
                        </div>
                    </div>

                    <div class="percentage">
                        {{ Math.round((score / questions.length) * 100) }}%
                    </div>

                    <div class="score-message">
                        <p v-if="(score / questions.length) >= 0.9">
                            üåü Doskona≈Çy wynik!
                        </p>
                        <p v-else-if="(score / questions.length) >= 0.7">
                            üëç Bardzo dobry wynik!
                        </p>
                        <p v-else-if="(score / questions.length) >= 0.5">
                            üìö Dobry start!
                        </p>
                        <p v-else>
                            üí™ Nie poddawaj siƒô!
                        </p>
                    </div>
                </div>

                <div class="actions">
                    <button @click="restartQuiz" class="btn btn-primary">
                        üîÑ Wr√≥ƒá do menu
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- SKRYPTY -->
    <script type="module" src="app.js"></script>
</body>
</html>